/**
 * Roundcube Bookmarks Plugin
 *
 * @version 2.2.1
 * @author Offerel
 * @copyright Copyright (c) 2020, Offerel
 * @license GNU General Public License, version 3
 */
function h_del(t,o,format){t.preventDefault();var e=rcmail.gettext("bookmarks_del","syncmarks").replace("%b%",o.innerHTML);if(1==confirm(e)){let r=encodeURIComponent(o.href),i=o.attributes.bid.value;rcmail.http_post("syncmarks/del_url","_url="+r+"&_format="+format+"&_bid="+i)}}function bookmarks_cmd(){"300"!=document.getElementById("bookmarkpane").clientWidth?rcmail.http_post("syncmarks/get_bookmarks","_url=2"):document.getElementById("bookmarkpane").style.width="0"}function add_url(format){var t=encodeURIComponent(prompt(rcmail.gettext("bookmarks_url","syncmarks")));0<t.length&&(t.startsWith("http")||t.startsWith("ftp"))&&rcmail.http_post("syncmarks/add_url","_url="+t+"&_format="+format)}function urladded(t){console.log(t.message),0<t.data.length&&$("#bookmarkpane").html(t.data)}function get_bookmarks(response){bookmarks=JSON.parse(response.data),$("#bookmarkpane").html(bookmarks),document.getElementById("bookmarkpane").style.width="300px"}function en_noti(){if("Notification"in window)if("granted"===Notification.permission)var notification=new Notification("Syncmarks",{body:"Notifications are now enabled for Syncmarks.",icon:"./plugins/syncmarks/bookmarks.png"});else"denied"!==Notification.permission&&Notification.requestPermission().then((function(permission){if("granted"===permission)var notification=new Notification("Syncmarks",{body:"Notifications are now enabled for Syncmarks.",icon:"./plugins/syncmarks/bookmarks.png"})}));else alert("This browser does not support desktop notification")}function get_notifications(response){let notifications;JSON.parse(response).forEach((function(notification){show_noti(notification)}))}function show_noti(noti){if("granted"!==Notification.permission)Notification.requestPermission();else{let notification;new Notification(noti.title,{body:noti.url,icon:"./plugins/syncmarks/bookmarks.png",requireInteraction:!0}).onclick=function(){window.open(noti.url),rcmail.http_post("syncmarks/del_not","&_nkey="+noti.nkey)}}}window.rcmail&&rcmail.addEventListener("init",(function(t){})),$(document).ready((function(){$("#7f3f3c06-5b85-4e7f-b527-d061478e9446").on("click",bookmarks_cmd),document.getElementById("bookmarkpane").addEventListener("click",(function(t){"A"==t.target.tagName&&bookmarks_cmd()}))})),rcmail.addEventListener("plugin.sendNotifications",get_notifications);